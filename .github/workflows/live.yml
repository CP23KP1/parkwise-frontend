name: LIVE

on:
    push:
        branches:
            - main

jobs:
    LIVE:
        runs-on: self-hosted

        steps:
            - name: Checkout ğŸ›
              uses: actions/checkout@master
              with:
                  path: "parkwise-frontend/"

            - name: Setup env ğŸ› 
              env:
                  PROD_ENV: ${{ secrets.PROD_ENV }}
              run: |
                  touch parkwise-frontend/.env
                  echo "$PROD_ENV" >> parkwise-frontend/.env

            - name: Build Docker Image ğŸ³
              run: docker build parkwise-frontend/ -t cp23kp1/node-parkwise-frontend

            - name: Remove exist container ğŸº
              run: docker rm -f parkwise-frontend

            - name: Run Docker Container ğŸº
              run: docker run --restart=always --network backend --name parkwise-frontend -d cp23kp1/node-parkwise-frontend
